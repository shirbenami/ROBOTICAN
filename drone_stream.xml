<mxfile host="app.diagrams.net" modified="2025-12-17T00:00:00.000Z" agent="GPT" version="24.7.17" type="device">
  <diagram id="arch1" name="Selected-Frames Architecture">
    <mxGraphModel dx="1200" dy="800" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="900" math="0" shadow="0">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>

        <!-- ===== Swimlanes / Containers ===== -->
        <mxCell id="droneLane" value="DRONE" style="swimlane;horizontal=0;startSize=28;rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#999999;" vertex="1" parent="1">
          <mxGeometry x="20" y="40" width="260" height="780" as="geometry"/>
        </mxCell>

        <mxCell id="laptopLane" value="LAPTOP (ROS2 network edge)" style="swimlane;horizontal=0;startSize=28;rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#999999;" vertex="1" parent="1">
          <mxGeometry x="310" y="40" width="540" height="780" as="geometry"/>
        </mxCell>

        <mxCell id="jetsonLane" value="JETSON AGX1" style="swimlane;horizontal=0;startSize=28;rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#999999;" vertex="1" parent="1">
          <mxGeometry x="880" y="40" width="500" height="780" as="geometry"/>
        </mxCell>

        <!-- Sub-containers inside Laptop -->
        <mxCell id="backendDocker" value="Backend Docker (Laptop)" style="swimlane;horizontal=1;startSize=24;rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#aaaaaa;" vertex="1" parent="laptopLane">
          <mxGeometry x="20" y="40" width="500" height="230" as="geometry"/>
        </mxCell>

        <mxCell id="humbleDocker" value="Humble Docker (Laptop)" style="swimlane;horizontal=1;startSize=24;rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#aaaaaa;" vertex="1" parent="laptopLane">
          <mxGeometry x="20" y="300" width="500" height="260" as="geometry"/>
        </mxCell>

        <mxCell id="laptopSelect" value="Selection / Gating (Laptop)" style="swimlane;horizontal=1;startSize=24;rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#aaaaaa;" vertex="1" parent="laptopLane">
          <mxGeometry x="20" y="590" width="500" height="170" as="geometry"/>
        </mxCell>

        <!-- ===== Nodes: Drone ===== -->
        <mxCell id="cam" value="Camera" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="droneLane">
          <mxGeometry x="30" y="70" width="200" height="60" as="geometry"/>
        </mxCell>

        <mxCell id="udp" value="Video Stream&#xa;H264/RTP over UDP" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="droneLane">
          <mxGeometry x="30" y="160" width="200" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="fcu" value="FCU / Autopilot" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="droneLane">
          <mxGeometry x="30" y="650" width="200" height="60" as="geometry"/>
        </mxCell>

        <!-- ===== Nodes: Laptop Backend Docker ===== -->
        <mxCell id="gst" value="GStreamer UDP Receiver / Decoder" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="backendDocker">
          <mxGeometry x="20" y="50" width="220" height="60" as="geometry"/>
        </mxCell>

        <mxCell id="imgpub" value="ROS2 Publisher&#xa;/camera/image_raw + /camera/camera_info" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="backendDocker">
          <mxGeometry x="260" y="50" width="220" height="60" as="geometry"/>
        </mxCell>

        <mxCell id="ctrl" value="Main Control Loop&#xa;ManualControl commands" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="backendDocker">
          <mxGeometry x="140" y="130" width="220" height="60" as="geometry"/>
        </mxCell>

        <!-- ===== Nodes: Laptop Humble Docker ===== -->
        <mxCell id="apriltag" value="AprilTag Node&#xa;(sub image + camera_info)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="humbleDocker">
          <mxGeometry x="20" y="60" width="220" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="azcalc" value="Azimuth Calculator (Python)&#xa;quantize: 0/90/180/270&#xa;+ debounce/hysteresis" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="humbleDocker">
          <mxGeometry x="260" y="60" width="220" height="90" as="geometry"/>
        </mxCell>

        <!-- ===== Nodes: Laptop Selection/Gating ===== -->
        <mxCell id="gate" value="Frame Gate / Selector&#xa;publish only selected frames&#xa;topic: /selected_frame" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="laptopSelect">
          <mxGeometry x="140" y="55" width="320" height="80" as="geometry"/>
        </mxCell>

        <!-- ===== Nodes: Jetson ===== -->
        <mxCell id="subSelected" value="Subscriber&#xa;/selected_frame" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="jetsonLane">
          <mxGeometry x="40" y="80" width="200" height="60" as="geometry"/>
        </mxCell>

        <mxCell id="save" value="Save Image to Disk" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="jetsonLane">
          <mxGeometry x="260" y="80" width="200" height="60" as="geometry"/>
        </mxCell>

        <mxCell id="vila" value="VILA Pipeline&#xa;OWL + VILA LLM" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="jetsonLane">
          <mxGeometry x="150" y="180" width="240" height="80" as="geometry"/>
        </mxCell>

        <mxCell id="out" value="Results / Logs / Publish" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#666666;" vertex="1" parent="jetsonLane">
          <mxGeometry x="150" y="290" width="240" height="60" as="geometry"/>
        </mxCell>

        <mxCell id="ddsNote" value="ROS2 DDS over network&#xa;(only selected frames)" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;fillColor=#ffffff;strokeColor=#999999;" vertex="1" parent="1">
          <mxGeometry x="720" y="610" width="150" height="60" as="geometry"/>
        </mxCell>

        <!-- ===== Edges ===== -->
        <mxCell id="e1" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" edge="1" parent="1" source="cam" target="udp">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e2" value="UDP" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" edge="1" parent="1" source="udp" target="gst">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e3" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" edge="1" parent="backendDocker" source="gst" target="imgpub">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e4" value="/camera/* (local laptop)" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" edge="1" parent="1" source="imgpub" target="apriltag">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e5" value="tag pose / detection" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" edge="1" parent="1" source="apriltag" target="azcalc">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e6" value="event + stamp" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" edge="1" parent="1" source="azcalc" target="gate">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e7" value="/selected_frame (network)" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" edge="1" parent="1" source="gate" target="subSelected">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e8" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" edge="1" parent="jetsonLane" source="subSelected" target="save">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e9" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" edge="1" parent="1" source="save" target="vila">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e10" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" edge="1" parent="1" source="vila" target="out">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e11" value="ManualControl" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" edge="1" parent="1" source="ctrl" target="fcu">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- Visual connection from note to network edge -->
        <mxCell id="e12" style="endArrow=none;html=1;dashed=1;strokeColor=#999999;" edge="1" parent="1" source="ddsNote" target="e7">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>

